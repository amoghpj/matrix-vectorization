Translated from R from Frederick Novomestky R package matrixcalc:

https://cran.r-project.org/web/packages/matrixcalc/index.html